<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Lançamentos</ion-title>
    <ion-buttons slot="primary">
      <ion-button id="btn-novo-lcto" color="*" fill="outline" (click)="showAddMenu()">
        Novo
        <ion-icon slot="end" name="create"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <mat-expansion-panel style="margin-bottom: 20px;">
    <mat-expansion-panel-header>
      <mat-panel-title>
        <ion-icon name="ios-options"></ion-icon>
        <ion-label>&nbsp;Filtros</ion-label>
      </mat-panel-title>
      <!--
      <mat-panel-description>
        This is a summary of the content
      </mat-panel-description>
      -->
    </mat-expansion-panel-header>

    <form #form="ngForm" (ngSubmit)="filtrar()">
      <ion-item>
        <ion-label position="stacked">Mês Base</ion-label>
        <ion-datetime
            name="mes_base"
            [(ngModel)]="frmFiltros.mes_base"
            display-format="MMMM/YYYY"
            picker-format="MMMM YYYY"
            month-names="Janeiro, Fevereiro, Março, Abril, Maio, Junho, Julho, Agosto, Setembro, Outubro, Novembro, Dezembro"
            (ionCancel)="clearInput('mes_base')"
            cancelText="Limpar"
            doneText="Selecionar"
            class="ion-text-start"
        ></ion-datetime>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Vcto Inicial</ion-label>
        <ion-datetime
          name="vcto_inicial"
          [(ngModel)]="frmFiltros.vcto_inicial"
          display-format="DD/MM/YYYY"
          picker-format="DD MMMM YYYY"
          month-names="Janeiro, Fevereiro, Março, Abril, Maio, Junho, Julho, Agosto, Setembro, Outubro, Novembro, Dezembro"
          (ionCancel)="clearInput('vcto_inicial')"
          cancelText="Limpar"
          doneText="Selecionar"
          class="ion-text-start"
        ></ion-datetime>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Vcto Final</ion-label>
        <ion-datetime
          name="vcto_final"
          [(ngModel)]="frmFiltros.vcto_final"
          display-format="DD/MM/YYYY"
          picker-format="DD MMMM YYYY"
          month-names="Janeiro, Fevereiro, Março, Abril, Maio, Junho, Julho, Agosto, Setembro, Outubro, Novembro, Dezembro"
          (ionCancel)="clearInput('vcto_final')"
          cancelText="Limpar"
          doneText="Selecionar"
          class="ion-text-start"
        ></ion-datetime>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Pgto Inicial</ion-label>
        <ion-datetime
          name="pgto_inicial"
          [(ngModel)]="frmFiltros.pgto_inicial"
          display-format="DD/MM/YYYY"
          picker-format="DD MMMM YYYY"
          month-names="Janeiro, Fevereiro, Março, Abril, Maio, Junho, Julho, Agosto, Setembro, Outubro, Novembro, Dezembro"
          (ionCancel)="clearInput('pgto_inicial')"
          cancelText="Limpar"
          doneText="Selecionar"
          class="ion-text-start"
        ></ion-datetime>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Pgto Final</ion-label>
        <ion-datetime
          name="pgto_final"
          [(ngModel)]="frmFiltros.pgto_final"
          display-format="DD/MM/YYYY"
          picker-format="DD MMMM YYYY"
          month-names="Janeiro, Fevereiro, Março, Abril, Maio, Junho, Julho, Agosto, Setembro, Outubro, Novembro, Dezembro"
          (ionCancel)="clearInput('pgto_final')"
          cancelText="Limpar"
          doneText="Selecionar"
          class="ion-text-start"
        ></ion-datetime>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Descrição</ion-label>
        <ion-input class="text-align-left" clearInput="true" name="descricao" [(ngModel)]="frmFiltros.descricao"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Conta</ion-label>
        <ion-select
          [(ngModel)]="frmFiltros.conta"
          name="conta"
          cancelText="Limpar"
          okText="Selecionar"
          (ionCancel)="clearInput('conta')"
          class="ion-text-start"
        >
          <ion-select-option *ngFor="let c of itensConta" [value]="c.con_id">{{c.con_nome}}</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Tipo</ion-label>
        <ion-select
          [(ngModel)]="frmFiltros.tipo"
          name="tipo"
          cancelText="Limpar"
          okText="Selecionar"
          (ionCancel)="clearInput('tipo')"
          class="ion-text-start"
        >
          <ion-select-option *ngFor="let t of itensTipo" [value]="t.id">{{t.text}}</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Categoria</ion-label>
        <ion-select
          [(ngModel)]="frmFiltros.categoria"
          name="categoria"
          cancelText="Limpar"
          okText="Selecionar"
          (ionCancel)="clearInput('categoria')"
          class="ion-text-start"
        >
          <ion-select-option *ngFor="let c of itensBaseDespesa" [value]="c.bdp_id">{{c.bdp_descricao}}</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Exibir</ion-label>
        <ion-select
          [(ngModel)]="frmFiltros.exibir"
          name="exibir"
          cancelText="Limpar"
          okText="Selecionar"
          (ionCancel)="clearInput('exibir')"
          class="ion-text-start"
        >
          <ion-select-option *ngFor="let e of itensExibir" [value]="e.id">{{e.text}}</ion-select-option>
        </ion-select>
      </ion-item>

      <div style="text-align: center; margin-top: 20px;">
        <button ion-button type="submit" color="" style="background-color: #49afcd; padding: 12px; color: #FFF;">FILTRAR</button>
      </div>
    </form>
  </mat-expansion-panel>

  <ion-list>
    <ion-list-header>
      <strong>Lançamentos</strong>
    </ion-list-header>

    <ion-item *ngFor="let l of infoTabela" (click)="editLcto(l.lanId)">
      <ion-grid [ngClass]="{'td-selected' : l.lanConfirmado == '1'}">
        <ion-row no-padding>
          <ion-col no-padding size="9">
            <ion-icon *ngIf="l.tipo == 'Despesa'" class="ion-float-left lcto-icon lcto-icon-despesa" name="md-remove-circle"></ion-icon>
            <ion-icon *ngIf="l.tipo == 'Receita'" class="ion-float-left lcto-icon lcto-icon-receita" name="md-add-circle"></ion-icon>
            <ion-icon *ngIf="l.tipo == 'Transferência'" class="ion-float-left lcto-icon" name="md-repeat"></ion-icon>
            <span class="ion-float-left lcto-despesa">{{l.lanDespesa}}</span>
          </ion-col>
          <ion-col no-padding size="3" class="ion-text-end">
            <span item-end class="lcto-valor">{{l.lanValor}}</span>
          </ion-col>
        </ion-row>
        <ion-row no-padding>
          <ion-col no-padding size="12">
            <span class="ion-float-left lcto-despesa-details">
              {{l.lanVcto}} | {{l.despesa}} |
              <ion-icon *ngIf="l.lanPgto != ''" class="lcto-icon" name="md-cash"></ion-icon>
            </span>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-item>
    <small class="ion-text-end" padding>Exibindo {{infoTabela.length}} linhas</small>
  </ion-list>

  <ion-grid>
    <ion-row>
      <ion-col size="12">
        <ion-list>
          <ion-list-header>
            Totais
          </ion-list-header>

          <ion-item>
            <ion-grid>
              <ion-row class="tot-row-green">
                <ion-col size="1">
                  <ion-icon class="icone-totais" name="cash"></ion-icon>
                </ion-col>
                <ion-col size="11"  class="texto-totais-direita">
                  <ion-label><b>R$ {{infoTotais.receita_total_valor}}</b></ion-label>
                  <ion-label class="label-texto-totais">Total Valor (Receita)</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>

          <ion-item>
            <ion-grid>
              <ion-row class="tot-row-green">
                <ion-col size="1">
                  <ion-icon class="icone-totais" name="cash"></ion-icon>
                </ion-col>
                <ion-col size="11"  class="texto-totais-direita">
                  <ion-label><b>R$ {{infoTotais.receita_total_pago}}</b></ion-label>
                  <ion-label class="label-texto-totais">Total Pago (Receita)</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>

          <ion-item>
            <ion-grid>
              <ion-row class="tot-row-green">
                <ion-col size="1">
                  <ion-icon class="icone-totais" name="cash"></ion-icon>
                </ion-col>
                <ion-col size="11"  class="texto-totais-direita">
                  <ion-label><b>R$ {{infoTotais.receita_total_nao_contab}}</b></ion-label>
                  <ion-label class="label-texto-totais">Total Não Contabilizado (Receita)</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>

          <ion-item>
            <ion-grid>
              <ion-row class="tot-row-red">
                <ion-col size="1">
                  <ion-icon class="icone-totais" name="cash"></ion-icon>
                </ion-col>
                <ion-col size="11"  class="texto-totais-direita">
                  <ion-label><b>R$ {{infoTotais.despesa_total_pago}}</b></ion-label>
                  <ion-label class="label-texto-totais">Total Valor (Despesa)</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>

          <ion-item>
            <ion-grid>
              <ion-row class="tot-row-red">
                <ion-col size="1">
                  <ion-icon class="icone-totais" name="cash"></ion-icon>
                </ion-col>
                <ion-col size="11"  class="texto-totais-direita">
                  <ion-label><b>R$ {{infoTotais.despesa_total_valor}}</b></ion-label>
                  <ion-label class="label-texto-totais">Total Pago (Despesa)</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>

          <ion-item>
            <ion-grid>
              <ion-row class="tot-row-red">
                <ion-col size="1">
                  <ion-icon class="icone-totais" name="cash"></ion-icon>
                </ion-col>
                <ion-col size="11"  class="texto-totais-direita">
                  <ion-label><b>R$ {{infoTotais.despesa_total_nao_contab}}</b></ion-label>
                  <ion-label class="label-texto-totais">Total Não Contabilizado (Despesa)</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
